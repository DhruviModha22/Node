<% if (typeof blog === 'undefined' || edit) { %>
    <h2><%= edit ? 'Edit Blog' : 'New Blog' %></h2>
    <% if (typeof error !== 'undefined') { %>
        <div class="error"><%= error %></div>
    <% } %>
    <form action="<%= edit ? '/blog/' + blog._id + '?_method=PUT' : '/blog' %>" method="POST">
        <label>Title: <input type="text" name="title" required value="<%= blog ? blog.title : '' %>"></label><br>
        <label>Content:<br><textarea name="content" rows="6" cols="40" required><%= blog ? blog.content : '' %></textarea></label><br>
        <button type="submit"><%= edit ? 'Update Blog' : 'Create Blog' %></button>
    </form>
    <% if (edit) { %>
        <a href="/blog/<%= blog._id %>">Cancel</a>
    <% } %>
<% } else { %>
    <h2><%= blog.title %></h2>
    <p>By <%= blog.author.username %></p>
    <p><%= blog.content %></p>
    <p><small>Posted on <%= blog.createdAt.toLocaleString() %></small></p>
    <% if (userId && userId == blog.author._id.toString()) { %>
        <a href="/blog/<%= blog._id %>/edit">Edit</a>
        <form action="/blog/<%= blog._id %>?_method=DELETE" method="POST" style="display:inline;">
            <button type="submit" onclick="return confirm('Are you sure you want to delete this blog?');">Delete</button>
        </form>
    <% } %>
<% } %> 